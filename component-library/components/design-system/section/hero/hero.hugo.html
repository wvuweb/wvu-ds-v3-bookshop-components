{{ $src := .background_image }}
{{ $backgroundColor := "wvu-blue" }}
{{ $headingColor := "text-wvu-gold" }}
{{ $placement := "mx-xl-auto text-center" }}
{{ $buttonColor := "primary" }}

{{ $audienceOverride := "" }}
{{ $toneOverride := "" }}

{{ if .settings.styles.audience }}
  {{ $audienceOverride = "override-audience-styles-site" }}
{{ end }}

{{ if .settings.styles.tone }}
  {{ $toneOverride = "override-tone-styles-site" }}
{{ end }}

{{ if .settings.styles.color_palette }}
  {{ $backgroundColor = .settings.styles.color_palette }}
{{ end }}

{{ if and .background_image (not .settings.styles.enable_blend) }}
  {{ $backgroundColor = "dark" }}
{{ end }}

{{- if not site.Params.env_bookshop_live -}}
  {{ $image := "" }}
  {{/*  Get the image, either from its remote or local source  */}}
  {{ if hasPrefix $src "http"}}
    {{ $image = resources.GetRemote .background_image }}
  {{ else }}
    {{ $image = resources.Get .background_image }}
  {{ end }}

  {{/* Resize images and add them to a variable  */}}
  {{ if and $image (ne $image.MediaType.SubType "svg") }}
    {{ if eq .imageProcess "fit" }}
      {{ $src = ($image.Fit (printf "%dx%d webp" 1920 1080)).RelPermalink }}
    {{ else }}
      {{ $src = ($image.Fill (printf "%dx%d webp" 1920 1080)).RelPermalink }}
    {{ end }}
  {{ end }}
{{- end -}}


<div class="row">
  <div class="col-xl-16 col-xxl-12 {{ .settings.layout.text_placement }}">
    {{- if not site.Params.env_bookshop_live -}}
      <h1 class="visually-hidden">{{ page.Params.title }}</h1>
    {{ end }}

    {{ with .label }}
      <p class="h6 mb-6 text-uppercase wvu-text-letter-spacing-lg">{{ . }}</p>
    {{ end }}
    
    {{ if .heading }}
      <h2 id="" class="wvu-b-display-heading wvu-b-accent-text wvu-b-text-shadow wvu-b-text-outline display-3" data-text="{{ .heading }}">
        <span class="wvu-b-font-adjust">{{ .heading }}</span>
      </h2>
    {{ end }}
    <p class="fs-3 mt-4 wvu-b-text wvu-b-subheading"><span class="xwvu-b-font-adjust">{{ .subheading }}</span></p>
    <div class="mt-4 wvu-b-text">
      {{ .body_text | markdownify }}
    </div>
    {{ range .ctas }}
      {{ if .button_c }}
        {{ $buttonColor = .button_c }}
      {{ end }}
      <a class="btn wvu-b-btn mb-1" href="{{ .url }}">{{ .text }} {{ with .icon }}<span class="fa-regular fa-{{ . }}"></span>{{ end }}</a>
      {{ $buttonColor := "primary" }}
    {{ end }}
  </div>
</div>